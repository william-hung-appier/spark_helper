# DISTINCT with predefined set

## Context/Background

- Prevent common errors when users use this extension
- Wish to have a single predefined set for DISTINCT script for letting CS team to know the log type in all tables under: `creative_perf_event`, `creative_quality`, and `creative_event`

- Currently need to select each table's distinct value for checking types:

```sql
SELECT DISTINCT type
FROM creative_perf_event_2025120100_2026011800
```

```sql
SELECT DISTINCT type
FROM creative_quality_2025120100_2026011800
```

```sql
SELECT DISTINCT event_type
FROM creative_event_2025120100_2026011800
```

## AS-IS (Before v2.1.0)

1. After user selecting the table will automatically jump to SELECT clause
2. There is no validation error warning if user didn't choose time interval
3. No quick entrance for user to use often used script for each table's type DISTINCT value

## TO-BE (v2.1.0 Implementation)

1. After selecting the table, focus jumps to the time input automatically
2. If user clicks "Generate Query" without entering time interval, an error message is shown
3. New "Quick Query" mode added as a third radio option alongside Standard and Distinct

## Implementation Details

### Query Type Options

The extension now has three query type modes:

| Mode | Description |
|------|-------------|
| **Standard** | Build custom SELECT queries with field selection |
| **Distinct** | Build SELECT DISTINCT queries with single field |
| **Quick Query** | Use predefined query templates (simplified view) |

### Quick Query Mode

When "Quick Query" is selected:
- Shows a simplified view with only Template, Time, and Timezone inputs
- Hides the standard FROM/SELECT/WHERE sections
- Generates UNION ALL queries across multiple tables

### Available Quick Query Templates

#### DISTINCT type (all creative tables)

Generates a combined query across all three creative tables with proper field mapping:

```sql
SELECT DISTINCT table_name, type
FROM (
SELECT 'creative_perf_event' AS table_name, type AS type
FROM creative_perf_event_2025120100_2026011800
UNION ALL
SELECT 'creative_quality' AS table_name, type AS type
FROM creative_quality_2025120100_2026011800
UNION ALL
SELECT 'creative_event' AS table_name, event_type AS type
FROM creative_event_2025120100_2026011800
)
ORDER BY table_name, type
```

Note: `creative_event` uses `event_type` field while others use `type`. The query normalizes this to a common `type` alias.

### Time Validation

- All modes require time interval (start and end time) before generating queries
- Error message displayed inline if validation fails
- Focus automatically moves to time input after table selection (in Standard/Distinct modes)

## Files Changed

| File | Changes |
|------|---------|
| `popup.html` | Added Quick Query radio option, Quick Query section with inputs |
| `src/js/quickQueries.js` | New file - defines quick query templates |
| `src/js/state.js` | Added quick query state management |
| `src/js/queryBuilder.js` | Added `generateQuickQuery()` and `generateUnionDistinct()` |
| `src/js/ui.js` | Added time validation, modified focus behavior |
| `src/js/app.js` | Wired Quick Query mode toggle, validation logic |
| `src/css/styles.css` | Added Quick Query section styling |
